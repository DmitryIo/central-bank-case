# Разработка модели выявления всплесков и периодических нарушений в работе ИТ-решений для Центрального Банка РФ

Подробное описание задачи и официальная ее постановка - [task_description](task_description)

## Постановка подзадач:
1. **Этап 1:** определить тип обращения - запрос (менее критичное событие) или инцидент (более критичное).
2. **Этап 2:** детектировать аномалии во временном ряде.

При анализе задачи мы пришли к выводу,что все подзадачи решаются последовательно, поэтому Этап 2 вытекает из этапа 1 (одно является продолжением другого). 

## Механика решения задачи и иструменты:
Мы сделали 2 отдельных подхода к решению задачи, первый подход - с использованием BERT:
* _из плюсов:_ показал хорошие значения целевых метрик (значение macro avg f1-score)
* _из минусов:_ обучается долго (7.5 минут на 5 эпох), сложен в интерпретации, поэтому от него решили отказаться для продолжения работы над 2-м этапом
 
Финальный набор инструментов - TF-IDF+LOGREG.
С помощью TFIDF работаем с текстовыми столбцами (а именно со столбцом Содержание), чтобы получить как можно больше полезной информации от текста.
Далее можно произвести кластеризацию обращений на основании предыдущего шага и сгруппировать их по смыслу.

## Структура
Для решения задачи последовательно запускаются следующие ноутбуки:
- [eda.ipynb](eda.ipynb) (разведовательный анализ данных)
- [baseline.ipynb](baseline.ipynb) (препроцессинг временных фичей, использование TF-IDF для выявления групп похожих обращений по смыслу, прогнозирование типа обращения и типа переклассификации, детекция аномалий, построение облаков слов для выявления паттернов аномалий).

Дополнительный ноутбук с реализованным алгоритмом BERT:
- [bert.ipynb](bert.ipynb)

## Результаты
Получившиеся результаты по метрикам:
| Метод | macro avg f1-score |
|------------|:------------:|
| TF-IDF + LogReg | 0.633 |
| BERT | **0.66** |

Submission-файлы:
- [final_submission.csv](final_submission.csv) (предсказания TF-IDF + LogReg)
- [submission_bert_wo_threshold.csv](submission_bert_wo_threshold.csv) (предсказания классов BERT)
- [submission_bert_w_threshold_0_35.csv](submission_bert_w_threshold_0_35.csv) (предсказания через вероятности классов с порогом в 0.35 BERT)
